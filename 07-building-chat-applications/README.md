# Создание генеративных чат-приложений на базе искусственного интеллекта

[![Создание генеративных чат-приложений на базе искусственного интеллекта](./images/07-lesson-banner.png?WT.mc_id=academic-105485-koreyst)](https://learn.microsoft.com/_themes/docs.theme/master/en-us/_themes/global/video-embed.html?id=57a31949-67c5-4020-8c85-91e4995589f3?WT.mc_id=academic-105485-koreyst)

> _(Нажмите на изображение выше, чтобы просмотреть видео этого урока.)_

Теперь, когда мы увидели, как создавать приложения для генерации текста, давайте рассмотрим приложения для чата.

Чат-приложения стали неотъемлемой частью нашей повседневной жизни, предлагая нам гораздо больше, чем просто возможность неформального общения. Они стали неотъемлемой частью обслуживания клиентов, технической поддержки и даже сложных консультационных систем. Вероятно, вы даже сами недавно вы получали помощь от чат-приложения. По мере интеграции более продвинутых технологий, таких как генеративный искусственный интеллект, возрастает сложность и возникают новые вызовы.

Некоторые вопросы, на которые нам нужно ответить:

- **Создание приложения**. Как эффективно создавать и плавно интегрировать эти приложения, работающие на базе искусственного интеллекта, для конкретных сценариев использования?
- **Мониторинг**. После развертывания, как мы можем отслеживать и гарантировать, что приложения работают на высоком уровне качества, как с точки зрения функциональности, так и с соблюдением [шести принципов ответственного использования искусственного интеллекта](https://www.microsoft.com/ai/responsible-ai?WT.mc_id=academic-105485-koreyst)?

По мере продвижения вперед в эпоху, определяемую автоматизацией и беспрепятственным взаимодействием человека с машиной, становится важным понимать, как генеративный искусственный интеллект изменяет область, глубину и адаптивность приложений чатов. В этом уроке будут рассмотрены аспекты архитектуры, которые поддерживают эти сложные системы, рассмотрены методы их настройки для выполнения задач в конкретной области и оценены метрики и соображения, необходимые для обеспечения ответственного развертывания искусственного интеллекта.

## Введение

Этот урок охватывает:

- Методы эффективного создания и интеграции чат-приложений.
- Как применять кастомизацию и тонкую настройку приложений.
- Стратегии и соображения по эффективному мониторингу приложений чата.

## Цели обучения

К концу этого урока вы сможете:

- Описать соображения по созданию и интеграции приложений чата в существующие системы.
- Настраивайте приложения чата для конкретных случаев использования.
- Определить ключевые показатели и соображения для эффективного мониторинга и поддержания качества чат-приложений на базе искусственного интеллекта.
- Обеспечить ответственне использование чатом искусственного интеллекта.

## Интеграция генеративного искусственного интеллекта в чат-приложения

Повышение уровня чат-приложений с помощью генеративного искусственного интеллекта не сводится только к их интеллектуальному развитию; это также оптимизация их архитектуры, производительности и пользовательского интерфейса для достижения качественного пользовательского опыта. Это включает исследование архитектурных основ, интеграции API и учета пользовательского интерфейса. Данная секция направлена на предоставление вам всесторонней дорожной карты для навигации по этим сложным областям, будь то интеграция в существующие системы или создание автономных платформ.

К концу этого раздела вы будете обладать знаниями, необходимыми для эффективного создания и внедрения чат-приложений.

### Чат-бот или приложение для чата?

Прежде чем мы начнем создавать чат-приложения, давайте сравним "чатботы" и "чат-приложения, работающие на базе искусственного интеллекта", которые выполняют различные роли и функции. Основная цель чатбота - автоматизировать определенные разговорные задачи, такие как ответы на часто задаваемые вопросы или отслеживание посылок. Обычно он управляется логикой на основе правил или сложными алгоритмами искусственного интеллекта. Чат-приложение же, работающее на базе искусственного интеллекта, является гораздо более масштабной средой, предназначенной для облегчения различных форм цифрового общения, таких как текстовые, голосовые и видеочаты между людьми. Его определяющей особенностью является интеграция генеративной модели искусственного интеллекта, которая симулирует тонкие диалоги, похожие на человеческие, генерируя ответы на основе разнообразных входных данных и контекстуальных подсказок. Чат-приложение, работающее на базе генеративного искусственного интеллекта, способно вести открытые диалоги, адаптироваться к изменяющимся контекстам разговора и даже создавать творческий или сложный диалог.

В таблице ниже представлены ключевые различия и сходства, которые помогут нам понять их уникальную роль в цифровой коммуникации.

| Чатбот                                                | Чат-приложение, работающее на базе генеративного искусственного интеллекта |
| ----------------------------------------------------- | ---------------------------------------------------------------------------|
| Ориентирован на задачи и основан на правилах          | Учитывает контекст                                                         |
| Часто интегрируется в более крупные системы           | Может содержать одного или нескольких чатботов                             |
| Ограничен программными функциями                      | Включает в себя генеративные модели искусственного интеллекта              |
| Специализированные и структурированные взаимодействия | Способен на обсуждения в открытой области                                  |

### Использование предварительно созданных функций с помощью SDK и API

При создании чат-приложения отличным первым шагом является оценка того, что уже существует. Использование SDK и API для создания чат-приложений является выгодной стратегией по различным причинам. Путем интеграции хорошо задокументированных SDK и API вы стратегически позиционируете свое приложение для долгосрочного успеха, учитывая масштабируемость и вопросы обслуживания.

- **Ускорение процесса разработки и снижение накладных расходов**: Ориентация на предварительно созданные функции вместо затратного процесса их создания позволяет сосредоточиться на других аспектах вашего приложения, которые вы можете считать более важными, таких как бизнес-логика.
- **Лучшая производительность**: При создании функциональности с нуля вы в конечном итоге зададите себе вопросы: "Как это масштабируется? Способно ли это приложение справиться с внезапным наплывом пользователей?" Хорошо поддерживаемые SDK и API часто имеют встроенные решения для этих вопросов.
- **Упрощенное обслуживание**: Обновлениями и улучшениями легче управлять, поскольку большинство API и SDK просто требуют обновления библиотек при выпуске новой версии.
- **Доступ к передовым технологиям**: Использование моделей, которые были точно настроены и обучены на обширных наборах данных, предоставляют вашему приложению возможности естественного языка.

Для доступа к функциональности SDK или API обычно требуется получить разрешение на использование предоставляемых сервисов, что часто осуществляется с помощью уникального ключа или аутентификационного токена. Мы будем использовать библиотеку OpenAI для Python, чтобы посмотреть, как это выглядит. Вы также можете попробовать это самостоятельно в следующей [заметке по OpenAI](./python/oai-assignment.ipynb?WT.mc_id=academic-105485-koreyst) или [заметке по Azure OpenAI Services](./python/aoai-assignment.ipynb?WT.mc_id=academic-105485-koreys) для этого урока.

```python
import os
from openai import OpenAI

API_KEY = os.getenv("OPENAI_API_KEY","")

client = OpenAI(
    api_key=API_KEY
    )

chat_completion = client.chat.completions.create(model="gpt-3.5-turbo", messages=[{"role": "user", "content": "Предложите два названия для учебного урока по чат-приложениям для генеративного ИИ."}])
```

В приведенном выше примере для завершения запроса используется модель GPT-3.5 Turbo, но обратите внимание, что ключ API устанавливается до этого. Вы получите сообщение об ошибке, если не установите ключ.

## Пользовательский опыт (User Experience (UX))

Общие принципы пользовательского опыта (UX) применимы к чат-приложениям, но в связи с использованием компонентов машинного обучения возникают дополнительные соображения.

- **Механизм разрешения неоднозначности:** Генеративные модели искусственного интеллекта иногда могут создавать неоднозначные ответы. Возможность запроса уточнения может быть полезной, если пользователь столкнется с этой проблемой.
- **Сохранение контекста:** Продвинутые генеративные модели искусственного интеллекта имеют способность запоминать контекст в рамках разговора, что может быть необходимым преимуществом для пользовательского опыта. Предоставление пользователям возможности управлять и контролировать контекст улучшает пользовательский опыт, но влечет риск сохранения чувствительной информации о пользователе. Рассмотрение вопросов хранения этой информации, таких как введение политики хранения, может найти баланс между необходимостью контекста и конфиденциальностью.
- **Персонализация:** Способность к обучению и адаптации позволяет искусственным интеллект моделям предлагать индивидуализированный опыт для пользователя. Настройка пользовательского опыта с помощью функций, таких как профили пользователей, не только создает ощущение понимания пользователей, но также помогает им в поиске конкретных ответов, что создает более эффективное и удовлетворительное взаимодействие.

Один из примеров персонализации - это настройки "Пользовательские инструкции" в ChatGPT от OpenAI. Они позволяют вам предоставить информацию о себе, которая может быть важным контекстом для ваших запросов. Вот пример пользовательской инструкции.

![Настройки "Пользовательские инструкции" в ChatGPT](./images/custom-instructions.png?WT.mc_id=academic-105485-koreyst)

Этот "профиль" побуждает ChatGPT создать план урока по связанным спискам. Обратите внимание, что ChatGPT учитывает, что пользователь может захотеть более подробный план урока, основанный на его опыте.

![Подсказка в ChatGPT для плана урока о связанных списках](./images/lesson-plan-prompt.png?WT.mc_id=academic-105485-koreyst)

### Microsoft System Message Framework для больших языковых моделей

[Microsoft предоставила рекомендации](https://learn.microsoft.com/azure/ai-services/openai/concepts/system-message#define-the-models-output-format?WT.mc_id=academic-105485-koreyst) для написания эффективных системных сообщений при генерации ответов с помощью LLM, разбитых на 4 области:

1. Определение для кого предназначена модель, а также ее возможности и ограничения.
2. Определение формата вывода модели.
3. Предоставление конкретных примеров, демонстрирующих предполагаемое поведение модели.
4. Установка дополнительных ограничений на поведение.

### Доступность

Независимо от того, есть ли у пользователя нарушения зрения, слуха, двигательных функций или познавательных способностей, хорошо спроектированное чат-приложение должно быть доступным для всех. Вот список конкретных функций, направленных на повышение доступности для различных видов ограничений пользователей.

- **Функции для людей с нарушениями зрения**: высококонтрастные темы и изменяемый размер текста, совместимость с программой чтения с экрана.
- **Функции для людей с нарушениями слуха**: функции преобразования текста в речь и речи в текст, визуальные подсказки для звуковых уведомлений.
- **Функции для людей с нарушениями моторики**: поддержка навигации с помощью клавиатуры, голосовые команды.
- **Функции для когнитивных нарушений**: упрощенные языковые параметры.

## Кастомизация и точная настройка для языковых моделей, специализированных для конкретных областей

Представьте себе чат-приложение, которое понимает жаргон вашей компании и предугадывает конкретные запросы, которые обычно возникают у его пользователей. Есть несколько подходов:

- **Использование моделей DSL**. DSL означает доменно-ориентированный язык. Вы можете использовать так называемую модель DSL, обученную для конкретного домена, чтобы понять его концепции и сценарии.
- **Применить тонкую настройку**. Точная настройка — это процесс дальнейшего обучения вашей модели конкретными данными.

## Кастомизация: использование DSL

Использование специализированных языковых моделей для определенной области (моделей DSL) может улучшить вовлеченность пользователей, предоставляя специализированные контекстно-релевантные взаимодействия. Это модель, которая обучается или настраивается для понимания и генерации текста, связанного с определенной областью, отраслью или предметом. Варианты использования модели DSL могут варьироваться от обучения с нуля до использования готовых решений через SDK и API. Еще один вариант - точная настройка, которая включает адаптацию существующей предварительно обученной модели для определенной области.

## Кастомизация: Применение точной настройки

Точная настройка (fine-tuning) часто рассматривается, когда предварительно обученная модель не справляется с задачами в специализированной области или конкретной задачей.

Например, медицинские запросы являются сложными и требуют множества контекста. Когда медицинский специалист ставит диагноз пациенту, он основывается на различных факторах, таких как образ жизни или наличие предыдущих заболеваний, и может даже опираться на свежие медицинские журналы для подтверждения своего диагноза. В таких тонких сценариях общего искусственного интеллекта в чат-приложении нельзя рассматривать как надежный источник информации.

### Сценарий: медицинское применение

Рассмотрим чат-приложение, разработанное для помощи медицинским специалистам, предоставляющее быстрый доступ к руководствам по лечению, взаимодействию лекарств или последним научным открытиям.

Универсальная модель может быть достаточной для ответа на базовые медицинские вопросы или предоставления общих рекомендаций, но она может испытывать трудности с следующим:

- **Очень специфические или сложные случаи.** Например, невролог может задать приложению вопрос: "Каковы текущие лучшие методы управления эпилепсией, устойчивой к лекарствам, у детей?"
- **Отсутствие последних достижений.** Универсальная модель может испытывать трудности в предоставлении актуального ответа, который учитывает самые последние достижения в нейрологии и фармакологии.

В таких случаях точная настройка модели с использованием специализированного медицинского набора данных может значительно улучшить её способность более точно и надёжно обрабатывать такие сложные медицинские запросы. Для этого требуется доступ к большому и соответствующему набору данных, который отражает специфические задачи и вопросы, связанные с конкретной областью.

## Рекомендации по обеспечению высококачественного чата на основе искусственного интеллекта

В данном разделе описываются критерии "высококачественных" чат-приложений, включая сбор действенных метрик и соблюдение фреймворка, ответственно использующего технологии искусственного интеллекта.

### Ключевые метрики

Для поддержания высококачественной работы приложения важно отслеживать основные метрики и аспекты. Эти измерения не только обеспечивают функциональность приложения, но также оценивают качество модели и пользовательский опыт. Ниже приведен список основных метрик, метрик искусственного интеллекта и метрик пользовательского опыта, которые следует учитывать.

| Метрика                       | Определение                                                                                                            | Ключевые аспекты для разработчика чат-приложения                              |
| ----------------------------- | ---------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- |
| **Время работы**              | Измеряет время, в течение которого приложение функционирует и доступно пользователям.                               | Каким образом вы будете минимизировать простои работы?                        |
| **Время отклика**             | Время, затрачиваемое приложением на ответ на запрос пользователя.                                                     | Как можно оптимизировать обработку запросов для улучшения времени отклика?      |
| **Точность**                  | Отношение верно положительных предсказаний к общему числу положительных предсказаний.                                | Как вы будете проверять точность вашей модели?                                |
| **Полнота (чувствительность)** | Отношение верно положительных предсказаний к реальному числу положительных случаев.                                  | Как вы будете измерять и улучшать полноту?                                   |
| **F1-мера**                   | Гармоническое среднее между точностью и полнотой, которое уравновешивает компромисс между ними.                        | Какой целевой уровень F1-меры вы ставите? Как вы сбалансируете точность и полноту? |
| **Перплексия**                | Отражает, насколько хорошо вероятностное распределение, предсказываемое моделью, соответствует реальному распределению данных. | Как вы будете минимизировать перплексию?                                      |
| **Метрики удовлетворенности пользователя** | Отражают восприятие пользователем приложения. Часто собираются с помощью опросов.                             | Как часто вы будете собирать отзывы пользователей? Как вы будете адаптироваться на основе этих отзывов? |
| **Уровень ошибок**            | Соотношение ошибочных предсказаний модели при понимании или выводе.                                                   | Какие стратегии у вас есть для снижения уровня ошибок?                        |
| **Циклы повторного обучения**   | Частота обновления модели для интеграции новых данных и исследований.                                                  | Как часто вы будете повторно обучать модель? Что становится причиной для повторного обучения? |
| **Обнаружение аномалий**       | Инструменты и методики для выявления необычных паттернов, не соответствующих ожидаемому поведению.                     | Как вы будете реагировать на аномалии?                                        |

## Внедрение принципов ответственного использования искусственного интеллекта в чат-приложениях.
Подход Microsoft к ответственному использованию искусственного интеллекта определяет шесть принципов, которыми должны руководствоваться разработчики и пользователи ИИ. Ниже приведены эти принципы, их определение и причины, по которым разработчики чат-приложений должны серьезно относиться к ним и учитывать их.

| Принципы                 | Определение Microsoft                                      | Рассмотрения для разработчика чат-приложений                            | Почему это важно                                                                                          |
| ------------------------ | --------------------------------------------------------- | ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------- |
| **Справедливость**       | ИИ-системы должны справедливо относиться к людям.           | Гарантировать, что чат-приложение не дискриминирует пользователей.       | Для создания доверия и включительности среди пользователей; избегает юридических последствий.              |
| **Надежность и безопасность** | ИИ-системы должны работать надежно и безопасно.          | Внедрять тестирование и механизмы безопасности для минимизации ошибок и рисков. | Обеспечивает удовлетворенность пользователя и предотвращает потенциальный вред.                              |
| **Конфиденциальность и безопасность** | ИИ-системы должны быть безопасными и уважать конфиденциальность. | Внедрять надежное шифрование и меры защиты данных.                        | Для защиты конфиденциальных данных пользователей и соблюдения законов о конфиденциальности.               |
| **Инклюзивность**        | ИИ-системы должны давать возможность всем и вовлекать людей. | Проектировать интерфейс, который доступен и удобен для разнообразных аудиторий. | Обеспечивает возможность использования приложения для широкого круга людей.                                |
| **Прозрачность**         | ИИ-системы должны быть понятными.                           | Предоставлять четкую документацию и обоснование решений ИИ.                | Пользователи склонны доверять системе, если они могут понять, как принимаются решения.                      |
| **Ответственность**      | Люди должны нести ответственность за ИИ-системы.           | Установить четкий процесс аудита и улучшения решений ИИ.                  | Обеспечивает непрерывное улучшение и корректировку в случае ошибок.                                        |

## Присвоение

Смотрите [задание](./python?WT.mc_id=academic-105485-koreyst), оно проведет вас через серию упражнений, начиная с запуска первых чат-подсказок, до классификации и суммирования текста и многого другого. Обратите внимание, что задания доступны на различных языках программирования!

## Отличная работа! Продолжайте свое путешествие!

После завершения этого урока, ознакомьтесь с нашей [коллекцией обучения по генеративному искусственному интеллекту](https://aka.ms/genai-collection?WT.mc_id=academic-105485-koreyst), чтобы продолжить повышать свои навыки в области генеративного ИИ!

Перейдите к Уроку 8, чтобы узнать, как вы можете [начать создавать поисковые приложения](../08-building-search-applications/README.md?WT.mc_id=academic-105485-koreyst)!